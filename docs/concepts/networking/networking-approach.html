<!doctype html>
<html lang="en" class="govuk-template no-js">
  <head>
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

    <title>Networking Approach - MoJ Modernisation Platform</title>

    <link href="../../stylesheets/manifest.css" rel="stylesheet" />

    <link rel="canonical" href="https://user-guide.modernisation-platform.service.justice.gov.uk/concepts/networking/networking-approach.html">

      <meta name="twitter:card" content="summary" />
      <meta name="twitter:domain" content="user-guide.modernisation-platform.service.justice.gov.uk" />
      <meta name="twitter:image" content="https://user-guide.modernisation-platform.service.justice.gov.uk/images/govuk-large.png" />
      <meta name="twitter:title" content="Networking Approach - MoJ Modernisation Platform" />
      <meta name="twitter:url" content="https://user-guide.modernisation-platform.service.justice.gov.uk/concepts/networking/networking-approach.html" />

      <meta property="og:image" content="https://user-guide.modernisation-platform.service.justice.gov.uk/images/govuk-large.png" />
      <meta property="og:site_name" content="MoJ Modernisation Platform" />
      <meta property="og:title" content="Networking Approach" />
      <meta property="og:type" content="object" />
      <meta property="og:url" content="https://user-guide.modernisation-platform.service.justice.gov.uk/concepts/networking/networking-approach.html" />

    
  </head>

  <body class="govuk-template__body">
    <script>document.body.className = ((document.body.className) ? document.body.className + ' js-enabled' : 'js-enabled');</script>

    <div class="app-pane">
      <div class="app-pane__header toc-open-disabled">
        <a href="#content" class="govuk-skip-link" data-module="govuk-skip-link">Skip to main content</a>

        <header class="govuk-header app-header" role="banner" data-module="govuk-header">
  <div class="govuk-header__container govuk-header__container--full-width">
    <div class="govuk-header__logo">
      <a href="/" class="govuk-header__link govuk-header__link--homepage">
        <span class="govuk-header__product-name">
          MoJ Modernisation Platform
        </span>
      </a>
    </div>
    <div class="govuk-header__content">
      <nav class="govuk-header__navigation govuk-header__navigation--end" aria-label="Menu">
        <button type="button" class="govuk-header__menu-button govuk-js-header-toggle" aria-controls="navigation" aria-label="Show or hide menu">Menu</button>
        <ul id="navigation" class="govuk-header__navigation-list">
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/modernisation-platform">Home</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="https://github.com/ministryofjustice/modernisation-platform">GitHub</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="https://mojdt.slack.com/archives/C01A7QK5VM1">Slack</a>
            </li>
        </ul>
      </nav>
    </div>
  </div>
</header>

      </div>

        <div id="toc-heading" class="toc-show fixedsticky">
          <button type="button" class="toc-show__label js-toc-show" aria-controls="toc">
            Table of contents <span class="toc-show__icon"></span>
          </button>
        </div>

      <div class="app-pane__body" data-module="in-page-navigation">
          <div class="app-pane__toc">
            <div class="toc" data-module="table-of-contents" tabindex="-1" aria-label="Table of contents" role="dialog">
              <div class="search" data-module="search" data-path-to-site-root="../../">
  <form action="https://www.google.co.uk/search" method="get" role="search" class="search__form govuk-!-margin-bottom-4">
    <input type="hidden" name="as_sitesearch" value="https://user-guide.modernisation-platform.service.justice.gov.uk"/>
    <label class="govuk-label search__label" for="search" aria-hidden="true">
      Search (via Google)
    </label>
    <input
      type="text"
      id="search" name="q"
      class="govuk-input govuk-!-margin-bottom-0 search__input"
      aria-controls="search-results"
      placeholder="Search">
    <button type="submit" class="search__button">Search</button>
  </form>
</div>

              <button type="button" class="toc__close js-toc-close" aria-controls="toc" aria-label="Hide table of contents"></button>
              <nav id="toc" class="js-toc-list toc__list" aria-labelledby="toc-heading">
                      <ul>
  <li>
    <a href="#networking-approach"><span>Networking Approach</span></a>
    <ul>
      <li>
        <ul>
          <li>
            <a href="#what-we-39-re-trying-to-fix"><span>What weâ€™re trying to fix</span></a>
          </li>
          <li>
            <a href="#what-we-investigated"><span>What we investigated</span></a>
          </li>
          <li>
            <a href="#what-we-decided"><span>What we decided</span></a>
          </li>
          <li>
            <a href="#diagram"><span>Diagram</span></a>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>


              </nav>
            </div>
          </div>

        <div class="app-pane__content toc-open-disabled">
          <main id="content" class="technical-documentation" data-module="anchored-headings">
            <h1 id="networking-approach">Networking Approach</h1>
<h3 id="what-we-39-re-trying-to-fix">What we&rsquo;re trying to fix</h3>
<p>Networking is hard, setting up a landing zone, a VPC, subnets, endpoints, peering, NACLS, gateways, etc, is both complex and time consuming.
We want to take care of this so that users can focus on what is important to them - their application.</p>
<h3 id="what-we-investigated">What we investigated</h3>
<p>We looked into having a <a href="https://docs.aws.amazon.com/vpc/latest/userguide/what-is-amazon-vpc.html">VPC</a> per account. Although this provides good network isolation, because we have one account per application environment, it would mean a lot of VPC peering would be required to connect one application to another if needed.</p>
<h3 id="what-we-decided">What we decided</h3>
<h4 id="vpcs">VPCs</h4>
<p>Instead of creating a VPC in each account, we have created separate environment accounts, and have one VPC per business unit, per environment.</p>
<p>So we have the following environment accounts:</p>

<ul>
<li>production</li>
<li>preproduction</li>
<li>test</li>
<li>development</li>
</ul>
<p>Within these environment accounts there is a VPC per business unit.  For example one VPC for the LAA, and one for HMPPS.</p>
<p>These VPCs are then shared via <a href="https://docs.aws.amazon.com/ram/latest/userguide/what-is.html">RAM</a> to the application accounts.</p>
<p>For example the production LAA VPC may be shared to multiple LAA application accounts, this enables LAA applications to communicate with each other without the need for <a href="https://docs.aws.amazon.com/vpc/latest/userguide/vpc-peering.html">VPC peering</a> as they are using the same VPC.</p>
<p>Connection to other VPCs, for example if an LAA application needs to communicate with a HMPPS application, is done through the <a href="#what-we-decided-transit-gateway">Transit Gateway</a>, <a href="#nacls">NACLs</a> can be opened to allow access, and <a href="https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html">security groups</a> from other accounts can be referenced.</p>
<h4 id="subnets">Subnets</h4>
<h5 id="general">General</h5>
<p>Each VPC will have a general subnet set - a set of subnets that can be used for most of the application accounts. These are shared to the application accounts using RAM.</p>
<p>For most business areas, the general subset set will be enough, but we can always create more subnet sets if needed.</p>
<p>The subnet sets contain three types of subnet:</p>

<ul>
<li>Public (for public resources such as load balancers)</li>
<li>Private (for private resources such as application servers)</li>
<li>Data (for data resources such as databases)</li>
</ul>
<p>Each of the different subnet types are spread across all three London region <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-regions-availability-zones.html#concepts-availability-zones">availability zones</a> (eu-west-2a, eu-west-2b and eu-west2c), making a total of nine subnets.</p>
<p>For more information on the subnet ranges, see the <a href="subnet-allocation.html">subnet allocation</a> page.</p>
<h5 id="protected">Protected</h5>
<p>Protected subnets are created per account and used for <a href="https://docs.aws.amazon.com/vpc/latest/privatelink/vpc-endpoints.html">VPC endpoints</a>. We provide the following VPC endpoints as standard, and can add additional ones as required:</p>

<ul>
<li>SSM Messages</li>
<li>S3</li>
<li>EC2</li>
<li>EC2 Messages</li>
</ul>
<h5 id="transit-gateway">Transit Gateway</h5>
<p>The <a href="#what-we-decided-transit-gateway">transit gateway</a> subnets are created per account to allow access to other accounts and services via the transit gateway.</p>
<h4 id="nacls">NACLs</h4>
<p>Access to the subnet sets is controlled with <a href="https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html">Network ACLs (NACLs)</a>.</p>
<p>By default these NACLs are locked down, allowing only egress and ingress to the public subnets.  We can add additional rules to allow your application to talk to services in different subnet sets as needed.</p>
<p>Egress traffic is allowed by a centralised NAT in network services account.</p>
<p>NACLs are not applied to Transit Gateway subnets, traffic is controlled at the subnet set level.</p>
<p>NACLs to the protected subnets only allow access from the private subnet sets over HTTPS to access endpoints.</p>
<h4 id="other-vpcs">Other VPCs</h4>
<p>There are other VPCs in the Modernisation Platform core infrastructure accounts, these are connected to the <a href="#what-we-decided-transit-gateway">transit gateway</a> as well.</p>
<p>Examples of some of these that you will connect to are:</p>

<ul>
<li>network-services (where the transit gateway lives)</li>
<li>shared-services</li>
<li>logging</li>
<li>security</li>
</ul>
<h4 id="what-we-decided-transit-gateway">Transit Gateway</h4>
<p>The <a href="https://docs.aws.amazon.com/vpc/latest/tgw/what-is-transit-gateway.html">transit gateway</a> allows us to interconnect the different VPCs to enable communication between business units. The Transit Gateway also enables connection to third parties external to the MoJ via a <a href="https://docs.aws.amazon.com/vpc/latest/userguide/vpn-connections.html">VPN</a>.
Routing is split into production and non production data for data protection.</p>
<p><a href="../../images/transit-gateway.png" rel="noopener noreferrer"><img src="../../images/transit-gateway.png" alt="Transit Gatway" /></a></p>
<h3 id="diagram">Diagram</h3>
<p><a href="../../images/shared-vpc.png" rel="noopener noreferrer"><img src="../../images/shared-vpc.png" alt="Shared VPC Diagram" /></a></p>
<p>For more information on how the VPC sharing fits into the bigger networking picture, see the main <a href="networking-diagram.html">networking diagram</a></p>

              <div data-module='page-expiry' data-last-reviewed-on="2022-11-19">
    <div class='page-expiry--not-expired'>
      This page was last reviewed on 19 May 2022.

        It needs to be reviewed again on 19 November 2022
        by the page owner <a href="https://mojdt.slack.com/messages/modernisation-platform">#modernisation-platform</a>
        .
    </div>

    <div class='page-expiry--expired'>
      This page was set to be reviewed before 19 November 2022
       by the page owner <a href="https://mojdt.slack.com/messages/modernisation-platform">#modernisation-platform</a>.
      This might mean the content is out of date.
    </div>
  </div>

          </main>

          <aside>
              <ul class="contribution-banner">
                <li><a href="https://github.com/ministryofjustice/modernisation-platform/blob/main/source/concepts/networking/networking-approach.html.md.erb">View source</a></li>
                <li><a href="https://github.com/ministryofjustice/modernisation-platform/issues/new?body=Problem+with+%27Networking+Approach%27+%28https%3A%2F%2Fuser-guide.modernisation-platform.service.justice.gov.uk%2Fconcepts%2Fnetworking%2Fnetworking-approach.html%29&amp;labels=bug&amp;title=Re%3A+%27Networking+Approach%27">Report problem</a></li>
                <li><a href="https://github.com/ministryofjustice/modernisation-platform">GitHub Repo</a></li>
              </ul>
          </aside>

          <footer class="govuk-footer app-footer" role="contentinfo">
  <div class="govuk-footer__meta">
    <div class="govuk-footer__meta-item govuk-footer__meta-item--grow">


      <svg
        aria-hidden="true"
        focusable="false"
        class="govuk-footer__licence-logo"
        xmlns="http://www.w3.org/2000/svg"
        viewbox="0 0 483.2 195.7"
        height="17"
        width="41"
      >
        <path
          fill="currentColor"
          d="M421.5 142.8V.1l-50.7 32.3v161.1h112.4v-50.7zm-122.3-9.6A47.12 47.12 0 0 1 221 97.8c0-26 21.1-47.1 47.1-47.1 16.7 0 31.4 8.7 39.7 21.8l42.7-27.2A97.63 97.63 0 0 0 268.1 0c-36.5 0-68.3 20.1-85.1 49.7A98 98 0 0 0 97.8 0C43.9 0 0 43.9 0 97.8s43.9 97.8 97.8 97.8c36.5 0 68.3-20.1 85.1-49.7a97.76 97.76 0 0 0 149.6 25.4l19.4 22.2h3v-87.8h-80l24.3 27.5zM97.8 145c-26 0-47.1-21.1-47.1-47.1s21.1-47.1 47.1-47.1 47.2 21 47.2 47S123.8 145 97.8 145"
        />
      </svg>
      <span class="govuk-footer__licence-description">
        All content is available under the
        <a
          class="govuk-footer__link"
          href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/"
          rel="license"
        >Open Government Licence v3.0</a>, except where otherwise stated
      </span>
    </div>
    <div class="govuk-footer__meta-item">
      <a
        class="govuk-footer__link govuk-footer__copyright-logo"
        href="https://www.nationalarchives.gov.uk/information-management/re-using-public-sector-information/uk-government-licensing-framework/crown-copyright/"
      >Â© Crown copyright</a>
    </div>
  </div>
</footer>

        </div>
      </div>
    </div>

    
    <script src="../../javascripts/application.js"></script>
  </body>
</html>
