<!doctype html>
<html lang="en" class="govuk-template no-js">
  <head>
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

    <title>How to configure DNS for public services - MoJ Modernisation Platform</title>

    <link href="../stylesheets/manifest.css" rel="stylesheet" />

    <link rel="canonical" href="https://user-guide.modernisation-platform.service.justice.gov.uk/user-guide/how-to-configure-dns.html">

      <meta name="twitter:card" content="summary" />
      <meta name="twitter:domain" content="user-guide.modernisation-platform.service.justice.gov.uk" />
      <meta name="twitter:image" content="https://user-guide.modernisation-platform.service.justice.gov.uk/images/govuk-large.png" />
      <meta name="twitter:title" content="How to configure DNS for public services - MoJ Modernisation Platform" />
      <meta name="twitter:url" content="https://user-guide.modernisation-platform.service.justice.gov.uk/user-guide/how-to-configure-dns.html" />

      <meta property="og:image" content="https://user-guide.modernisation-platform.service.justice.gov.uk/images/govuk-large.png" />
      <meta property="og:site_name" content="MoJ Modernisation Platform" />
      <meta property="og:title" content="How to configure DNS for public services" />
      <meta property="og:type" content="object" />
      <meta property="og:url" content="https://user-guide.modernisation-platform.service.justice.gov.uk/user-guide/how-to-configure-dns.html" />

    
  </head>

  <body class="govuk-template__body">
    <script>document.body.className = ((document.body.className) ? document.body.className + ' js-enabled' : 'js-enabled');</script>

    <div class="app-pane">
      <div class="app-pane__header toc-open-disabled">
        <a href="#content" class="govuk-skip-link" data-module="govuk-skip-link">Skip to main content</a>

        <header class="govuk-header app-header" role="banner" data-module="govuk-header">
  <div class="govuk-header__container govuk-header__container--full-width">
    <div class="govuk-header__logo">
      <a href="/" class="govuk-header__link govuk-header__link--homepage">
        <span class="govuk-header__product-name">
          MoJ Modernisation Platform
        </span>
      </a>
    </div>
    <div class="govuk-header__content">
      <nav class="govuk-header__navigation govuk-header__navigation--end" aria-label="Menu">
        <button type="button" class="govuk-header__menu-button govuk-js-header-toggle" aria-controls="navigation" aria-label="Show or hide menu">Menu</button>
        <ul id="navigation" class="govuk-header__navigation-list">
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/modernisation-platform">Home</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="https://github.com/ministryofjustice/modernisation-platform">GitHub</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="https://mojdt.slack.com/archives/C01A7QK5VM1">Slack</a>
            </li>
        </ul>
      </nav>
    </div>
  </div>
</header>

      </div>

        <div id="toc-heading" class="toc-show fixedsticky">
          <button type="button" class="toc-show__label js-toc-show" aria-controls="toc">
            Table of contents <span class="toc-show__icon"></span>
          </button>
        </div>

      <div class="app-pane__body" data-module="in-page-navigation">
          <div class="app-pane__toc">
            <div class="toc" data-module="table-of-contents" tabindex="-1" aria-label="Table of contents" role="dialog">
              <div class="search" data-module="search" data-path-to-site-root="../">
  <form action="https://www.google.co.uk/search" method="get" role="search" class="search__form govuk-!-margin-bottom-4">
    <input type="hidden" name="as_sitesearch" value="https://user-guide.modernisation-platform.service.justice.gov.uk"/>
    <label class="govuk-label search__label" for="search" aria-hidden="true">
      Search (via Google)
    </label>
    <input
      type="text"
      id="search" name="q"
      class="govuk-input govuk-!-margin-bottom-0 search__input"
      aria-controls="search-results"
      placeholder="Search">
    <button type="submit" class="search__button">Search</button>
  </form>
</div>

              <button type="button" class="toc__close js-toc-close" aria-controls="toc" aria-label="Hide table of contents"></button>
              <nav id="toc" class="js-toc-list toc__list" aria-labelledby="toc-heading">
                      <ul>
  <li>
    <a href="#how-to-configure-dns-for-public-services"><span>How to configure DNS for public services</span></a>
    <ul>
      <li>
        <a href="#introduction"><span>Introduction</span></a>
      </li>
      <li>
        <a href="#dns-with-acm-certificate"><span>DNS with ACM certificate</span></a>
        <ul>
          <li>
            <a href="#non-production-environments"><span>Non production environments</span></a>
          </li>
          <li>
            <a href="#production-environments"><span>Production environments</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="#dns-with-gandi-net-certificate"><span>DNS with Gandi.net certificate</span></a>
        <ul>
          <li>
            <a href="#dns-with-gandi-net-certificate-non-production-environments"><span>Non production environments</span></a>
          </li>
          <li>
            <a href="#dns-with-gandi-net-certificate-production-environments"><span>Production environments</span></a>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>


              </nav>
            </div>
          </div>

        <div class="app-pane__content toc-open-disabled">
          <main id="content" class="technical-documentation" data-module="anchored-headings">
            <h1 id="how-to-configure-dns-for-public-services">How to configure DNS for public services</h1>
<h2 id="introduction">Introduction</h2>
<p>In order for users to access public facing services with a URL (Uniform Resource Locator), DNS (Domain Name System) records must be created, and associated with a valid certificate.</p>
<p>This will enable users to securely access services over HTTPS (Hypertext Transfer Protocol Secure).</p>
<p>There are two main ways to use certificates for DNS on the Modernisation Platform; <a href="https://aws.amazon.com/certificate-manager/">ACM</a> (Amazon Certificate Manager) public certificates, and <a href="https://operations-engineering.service.justice.gov.uk/documentation/services/SSL-certificate-management.html">Gandi.net</a> certificates imported into ACM.</p>
<p>Unless there is a good reason, ACM public certificates should be used as they are automatically managed and renewed.  Gandi.net certificates cost more and require manual renewal.</p>
<h2 id="dns-with-acm-certificate">DNS with ACM certificate</h2>
<p><a href="../images/dns-with-acm.png" rel="noopener noreferrer"><img src="../images/dns-with-acm.png" alt="DNS with ACM" /></a></p>
<h3 id="non-production-environments">Non production environments</h3>
<p>Non production environments should use the <a href="https://user-guide.modernisation-platform.service.justice.gov.uk/concepts/networking/dns.html#dns-naming">Modernisation Platform domain naming standards</a>.</p>
<p>The following resources need to be created in different AWS accounts (see diagram above), the table details the resources and the AWS provider required for them.</p>
<div class="table-container">
        <table>
          <tr>
<th>Resource</th>
<th>Terraform Resource</th>
<th>Terraform Provider</th>
<th>Description</th>
</tr><tr>
<td>ACM Public Certificate</td>
<td>aws_acm_certificate</td>
<td>default</td>
<td>ACM Public certificate created in the application account. The domain name should equal the main modernisation-platform domain, &ldquo;modernisation-platform.service.justice.gov.uk&rdquo;, the SAN (subject alternative name) should equal the DNS record name entry, eg &ldquo;my-application.hmpps-test.modernisation-platform.service.justice.gov.uk&rdquo;</td>
</tr><tr>
<td>Route53 DNS record for certificate validation</td>
<td>aws_route53_record</td>
<td>aws.core-network-services</td>
<td>Created in the modernisation-platform hosted zone, this record validates the public certificate.</td>
</tr><tr>
<td>Route53 DNS record for directing traffic to the service</td>
<td>aws_route53_record</td>
<td>aws.core-vpc</td>
<td>Created in the hosted zone for the environment and business unit, eg &ldquo;my-application.hmpps-test.modernisation-platform.service.justice.gov.uk&rdquo;.</td>
</tr>
        </table>
      </div><h3 id="production-environments">Production environments</h3>
<p>Production environments should use a <code>service.justice.gov.uk</code> domain as per MoJ <a href="https://technical-guidance.service.justice.gov.uk/documentation/standards/naming-domains.html#naming-domains">naming domains</a> guidance.</p>
<p>The Modernisation Platform will need to request the delegation of the application domain (eg <code>my-application.service.justice.gov.uk</code>) from the <a href="https://operations-engineering.service.justice.gov.uk/documentation/services/domain-management.html#domain-management">Operations Engineering</a> team.  Please contact the Modernisation Platform team in the <a href="https://mojdt.slack.com/archives/C01A7QK5VM1">#ask-modernisation-platform</a> Slack channel to do this.</p>
<p>The Modernisation Platform team will then create a <a href="https://github.com/ministryofjustice/modernisation-platform/blob/main/terraform/environments/core-network-services/route53.tf#L5">hosted zone</a> for your domain.
Once this has been completed the following resources need to be created in different AWS accounts (see diagram above), the table details the resources and the AWS provider required for them.</p>
<div class="table-container">
        <table>
          <tr>
<th>Resource</th>
<th>Terraform Resource</th>
<th>Terraform Provider</th>
<th>Description</th>
</tr><tr>
<td>ACM Public Certificate</td>
<td>aws_acm_certificate</td>
<td>default</td>
<td>ACM Public certificate created in the application account. The domain name should equal the application domain, &ldquo;my-application.service.justice.gov.uk&rdquo;</td>
</tr><tr>
<td>Route53 DNS record for certificate validation</td>
<td>aws_route53_record</td>
<td>aws.core-network-services</td>
<td>Created in the application hosted zone, this record validates the public certificate.</td>
</tr><tr>
<td>Route53 DNS record for directing traffic to the service</td>
<td>aws_route53_record</td>
<td>aws.core-network-services</td>
<td>Created in the application hosted zone, eg &ldquo;my-application.service.justice.gov.uk&rdquo;.</td>
</tr>
        </table>
      </div><h2 id="dns-with-gandi-net-certificate">DNS with Gandi.net certificate</h2>
<p><a href="../images/dns-with-gandi.png" rel="noopener noreferrer"><img src="../images/dns-with-gandi.png" alt="DNS with Gandi" /></a></p>
<p>Gandi.net certificates should only be used if it is not possible to use ACM, for example some applications require the certificate to be installed on the server if HTTPS terminates on the server rather than the load balancer.</p>
<h3 id="dns-with-gandi-net-certificate-non-production-environments">Non production environments</h3>
<p>Non production environments should use ACM public certificate as detailed above unless necessary.</p>
<h3 id="dns-with-gandi-net-certificate-production-environments">Production environments</h3>
<p>The Modernisation Platform will need to request the delegation of the application domain (eg <code>my-application.service.justice.gov.uk</code>) from the <a href="https://operations-engineering.service.justice.gov.uk/documentation/services/domain-management.html#domain-management">Operations Engineering</a> team, along with a new Gandi.net certificate.  Please contact the Modernisation Platform team in the <a href="https://mojdt.slack.com/archives/C01A7QK5VM1">#ask-modernisation-platform</a> Slack channel to do this.</p>
<p>The Modernisation Platform team will then create a <a href="https://github.com/ministryofjustice/modernisation-platform/blob/main/terraform/environments/core-network-services/route53.tf#L5">hosted zone</a> for your domain and a validation record for the Gandi.net certificate.
Once this has been completed the following resources need to be created in different AWS accounts (see diagram above), the table details the resources and the AWS provider required for them.</p>
<div class="table-container">
        <table>
          <tr>
<th>Resource</th>
<th>Terraform Resource</th>
<th>Terraform Provider</th>
<th>Description</th>
</tr><tr>
<td>Gandi.net certificate in ACM</td>
<td>N/A</td>
<td>N/A</td>
<td>The new certificate should be <a href="certificate-import.html">imported into ACM</a> in the application production account.</td>
</tr><tr>
<td>Data look up for the certificate in ACM</td>
<td>aws_acm_certificate (data)</td>
<td>default</td>
<td>Data source to enable to imported certificate to be used by AWS services such as an elastic load balancer.</td>
</tr><tr>
<td>Route53 DNS record for directing traffic to the service</td>
<td>aws_route53_record</td>
<td>aws.core-network-services</td>
<td>Created in the application hosted zone, eg &ldquo;my-application.service.justice.gov.uk&rdquo;.</td>
</tr>
        </table>
      </div><p>The certificate should also be installed in the application as needed.</p>

              <div data-module='page-expiry' data-last-reviewed-on="2023-01-15">
    <div class='page-expiry--not-expired'>
      This page was last reviewed on 15 July 2022.

        It needs to be reviewed again on 15 January 2023
        by the page owner <a href="https://mojdt.slack.com/messages/modernisation-platform">#modernisation-platform</a>
        .
    </div>

    <div class='page-expiry--expired'>
      This page was set to be reviewed before 15 January 2023
       by the page owner <a href="https://mojdt.slack.com/messages/modernisation-platform">#modernisation-platform</a>.
      This might mean the content is out of date.
    </div>
  </div>

          </main>

          <aside>
              <ul class="contribution-banner">
                <li><a href="https://github.com/ministryofjustice/modernisation-platform/blob/main/source/user-guide/how-to-configure-dns.html.md.erb">View source</a></li>
                <li><a href="https://github.com/ministryofjustice/modernisation-platform/issues/new?body=Problem+with+%27How+to+configure+DNS+for+public+services%27+%28https%3A%2F%2Fuser-guide.modernisation-platform.service.justice.gov.uk%2Fuser-guide%2Fhow-to-configure-dns.html%29&amp;labels=bug&amp;title=Re%3A+%27How+to+configure+DNS+for+public+services%27">Report problem</a></li>
                <li><a href="https://github.com/ministryofjustice/modernisation-platform">GitHub Repo</a></li>
              </ul>
          </aside>

          <footer class="govuk-footer app-footer" role="contentinfo">
  <div class="govuk-footer__meta">
    <div class="govuk-footer__meta-item govuk-footer__meta-item--grow">


      <svg
        aria-hidden="true"
        focusable="false"
        class="govuk-footer__licence-logo"
        xmlns="http://www.w3.org/2000/svg"
        viewbox="0 0 483.2 195.7"
        height="17"
        width="41"
      >
        <path
          fill="currentColor"
          d="M421.5 142.8V.1l-50.7 32.3v161.1h112.4v-50.7zm-122.3-9.6A47.12 47.12 0 0 1 221 97.8c0-26 21.1-47.1 47.1-47.1 16.7 0 31.4 8.7 39.7 21.8l42.7-27.2A97.63 97.63 0 0 0 268.1 0c-36.5 0-68.3 20.1-85.1 49.7A98 98 0 0 0 97.8 0C43.9 0 0 43.9 0 97.8s43.9 97.8 97.8 97.8c36.5 0 68.3-20.1 85.1-49.7a97.76 97.76 0 0 0 149.6 25.4l19.4 22.2h3v-87.8h-80l24.3 27.5zM97.8 145c-26 0-47.1-21.1-47.1-47.1s21.1-47.1 47.1-47.1 47.2 21 47.2 47S123.8 145 97.8 145"
        />
      </svg>
      <span class="govuk-footer__licence-description">
        All content is available under the
        <a
          class="govuk-footer__link"
          href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/"
          rel="license"
        >Open Government Licence v3.0</a>, except where otherwise stated
      </span>
    </div>
    <div class="govuk-footer__meta-item">
      <a
        class="govuk-footer__link govuk-footer__copyright-logo"
        href="https://www.nationalarchives.gov.uk/information-management/re-using-public-sector-information/uk-government-licensing-framework/crown-copyright/"
      >Â© Crown copyright</a>
    </div>
  </div>
</footer>

        </div>
      </div>
    </div>

    
    <script src="../javascripts/application.js"></script>
  </body>
</html>
